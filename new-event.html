<!DOCTYPE html>
<html>
<head>
  <title>crear evento</title>
  <meta charset="UTF-8">
  <style>
    body {
        background-color: #030527;
  font-family: Arial, sans-serif;
  margin: 0;
}

.main-container{
  display: flex;
  justify-content: center;
  align-items: center;
}

.container {
  border-radius: 10px;
  padding: 20px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
  width: 30%;
}

.new-event-box {
  background-color: white;
  padding: 20px;
  border-radius: 5px;
}

h2 {
  text-align: center;
  margin-bottom: 20px;
}

.input-group {
  margin-bottom: 15px;
}

label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
}

input {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 5px;
  box-sizing: border-box;
}



.btn {
    font-family: "Oswald", sans-serif;
    padding: 10px 20px;
    border: none;
    border-radius: 25px;
    background-color: #68f7c4; 
    color: black;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
    font-weight: bold;
}

.btn:hover {
    background-color: #1f946b;
    color:white;
}


.btn-cancel {
    font-family: "Oswald", sans-serif;
    padding: 10px 20px;
    border: 1px solid #ddd;
    border-radius: 25px;
    background-color: #ffffff; 
    color: black;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
    font-weight: bold;
}




.btn-cancel:hover {
    background-color: #848484;
    color:white;
}



.btn-delete {
    font-family: "Oswald", sans-serif;
    padding: 10px 20px;
    border: 1px solid #f79191;
    border-radius: 25px;
    background-color: #f76868; 
    color: rgb(255, 255, 255);
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
    font-weight: bold;
}

.btn-delete:hover {
    background-color: #ae4242;
    color:white;
}
.center{
    display: flex;
    justify-content: center;
}

.close-session{
  display: flex;
  justify-content: flex-end;
  width: 100%;
}

.close-session a{
  color: white;
}

.white{
  color:white;
}

table {
        width: 100%;
        border-collapse: collapse;
    }

    td {
      color:white;
    }

    th, td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }

    th {
        background-color: #f2f2f2;
    }

    .container-table {
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        width: 70%;
    }

  </style>
</head>
<body>

  <div class="close-session">
    <a href="#" id="cerrarSesionLink">Cerrar Sesión</a>
  </div>

  <br/>
<div class="main-container">
  <div class="container">

    <div id="newEventForm" class="new-event-box">
      <h2>Crear evento</h2>
      <form onsubmit="event.preventDefault(); guardarEvento();">
        <div class="input-group">
          <label for="nameevent">Nombre evento</label>
          <input type="text" id="nameevent" placeholder="Ingresa nombre del evento">
        </div>
        <div class="input-group">
          <label for="date">Fecha</label>
          <input type="date" id="date" placeholder="Ingresa la fecha">
        </div>
        <div class="input-group">
          <label for="hour">Hora</label>
          <input type="time" id="hour" placeholder="Ingresa  la hora">
        </div>
        <div class="input-group">
          <label for="place">Lugar</label>
          <input type="text" id="place" placeholder="Ingresa lugar">
        </div>
        <div class="input-group">
          <label for="type">Tipo</label>
          <select id="type" style="width: 100%; border-radius: 8px; padding: 10px;">
            <option value="1">Música en el parque</option>
            <option value="2">Boda</option>
            <option value="3">Concierto</option>
        </select>
        </div>
        <div class="center">
            <button type="submit" class="btn">Crear Nuevo Evento</button>
        </div>
      </form>
    </div>

    <div id="editEventForm" class="new-event-box" style="display: none;">
      <h2>Editar evento</h2>
      <form onsubmit="event.preventDefault(); actualizarEvento();">
        <div class="input-group">
          <label for="editNameevent">Nombre evento</label>
          <input type="text" id="editNameevent" placeholder="Ingresa nombre del evento">
        </div>
        <div class="input-group">
          <label for="editDate">Fecha</label>
          <input type="date" id="editDate" placeholder="Ingresa la fecha">
        </div>
        <div class="input-group">
          <label for="editHour">Hora</label>
          <input type="time" id="editHour" placeholder="Ingresa  la hora">
        </div>
        <div class="input-group">
          <label for="editPlace">Lugar</label>
          <input type="text" id="editPlace" placeholder="Ingresa lugar">
        </div>
        <div class="input-group">
          <label for="editType">Tipo</label>
          <select id="editType" style="width: 100%; border-radius: 8px; padding: 10px;">
            <option value="1">Música en el parque</option>
            <option value="2">Boda</option>
            <option value="3">Concierto</option>
          </select>
        </div>
        <div class="center">
          <button type="submit" class="btn">Actualizar Evento</button>
          <button type="button" class="btn btn-cancel" style="margin-left: 5px;" onclick="cancelarEdicion()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="main-container">
  <div class="container-table">
    <h2 class="white">Eventos Creados</h2>
    <table>
      <thead>
        <tr>
          <th>Nombre Evento</th>
          <th>Fecha</th>
          <th>Hora</th>
          <th>Lugar</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody id="eventsList">
      </tbody>
    </table>
  </div>
</div>


<script>

    // Función para cerrar la sesión
    function cerrarSesion() {
    // Asignar localStorage
    localStorage.setItem('sessionStarted', false);
    // Redireccionar a home.html
    window.location.href = 'home.html';
  }

  // Obtener el enlace
  const cerrarSesionLink = document.getElementById('cerrarSesionLink');

  // Asignar la función cerrarSesion al evento click del enlace
  cerrarSesionLink.addEventListener('click', function(event) {
    event.preventDefault(); // Evitar el comportamiento predeterminado del enlace
    cerrarSesion(); // Llamar a la función cerrarSesion
  });

  function beforeDOMLoad() {
      var session = localStorage.getItem('sessionStarted');
      if(session != "true"){
        alert("No tiene una sesión valida");
        window.location.href = 'home.html';
      }
    }

    beforeDOMLoad();

  // Función para guardar un evento en localStorage
  function guardarEvento() {
    const nombreEvento = document.getElementById('nameevent').value;
    const fecha = document.getElementById('date').value;
    const hora = document.getElementById('hour').value;
    const lugar = document.getElementById('place').value;
    const tipo = document.getElementById('type').value;

    // Creamos un objeto evento con los datos
    const evento = {
      titulo: nombreEvento,
      fechaHora: `${fecha}T${hora}`,
      type: parseInt(tipo),
      lugar: lugar
    };

    // Obtenemos el array de eventos guardados en localStorage
    let eventos = JSON.parse(localStorage.getItem('eventos')) || [];

    // Agregamos el nuevo evento al array
    eventos.push(evento);

    // Guardamos el array de eventos actualizado en localStorage
    localStorage.setItem('eventos', JSON.stringify(eventos));

    // Limpiamos los campos del formulario
    document.getElementById('nameevent').value = '';
    document.getElementById('date').value = '';
    document.getElementById('hour').value = '';
    document.getElementById('place').value = '';
    document.getElementById('type').value = '1';

    // Refrescamos la tabla
    mostrarEventos();
  }

  // Función para mostrar los eventos en la tabla
  function mostrarEventos() {
    const eventos = JSON.parse(localStorage.getItem('eventos')) || [];

    const tbody = document.getElementById('eventsList');
    tbody.innerHTML = '';

    eventos.forEach((evento, index) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${evento.titulo}</td>
        <td>${new Date(evento.fechaHora).toLocaleDateString()}</td>
        <td>${new Date(evento.fechaHora).toLocaleTimeString()}</td>
        <td>${evento.lugar}</td>
        <td>
          <button class="btn" onclick="editarEvento(${index})">Editar</button>
          <button class="btn btn-delete" onclick="borrarEvento(${index})">Borrar</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  // Función para editar un evento
  function editarEvento(index) {
  const eventos = JSON.parse(localStorage.getItem('eventos')) || [];
  const evento = eventos[index];

  document.getElementById('editNameevent').value = evento.titulo;
  document.getElementById('editDate').value = evento.fechaHora.split('T')[0];
  document.getElementById('editHour').value = evento.fechaHora.split('T')[1];
  document.getElementById('editPlace').value = evento.lugar;
  document.getElementById('editType').value = evento.type;

  // Mostramos el formulario de edición y ocultamos el de creación
  document.getElementById('editEventForm').style.display = 'block';
  document.getElementById('newEventForm').style.display = 'none';

  // Almacenamos el índice del evento que se está editando para usarlo al actualizar
  document.getElementById('editEventForm').dataset.index = index;
}

function cancelarEdicion() {
  document.getElementById('editEventForm').style.display = 'none';
  document.getElementById('newEventForm').style.display = 'block';
}

function actualizarEvento() {
  const index = parseInt(document.getElementById('editEventForm').dataset.index);
  const nombreEvento = document.getElementById('editNameevent').value;
  const fecha = document.getElementById('editDate').value;
  const hora = document.getElementById('editHour').value;
  const lugar = document.getElementById('editPlace').value;
  const tipo = document.getElementById('editType').value;

  const eventos = JSON.parse(localStorage.getItem('eventos')) || [];
  eventos[index] = {
    titulo: nombreEvento,
    fechaHora: `${fecha}T${hora}`,
    type: parseInt(tipo),
    lugar: lugar
  };

  localStorage.setItem('eventos', JSON.stringify(eventos));

  mostrarEventos();
  cancelarEdicion();
}


  // Función para borrar un evento
  function borrarEvento(index) {
    // Obtenemos el array de eventos guardados en localStorage
    let eventos = JSON.parse(localStorage.getItem('eventos')) || [];

    // Borramos el evento con el índice especificado
    eventos.splice(index, 1);

    // Guardamos el array de eventos actualizado en localStorage
    localStorage.setItem('eventos', JSON.stringify(eventos));

    // Refrescamos la tabla
    mostrarEventos();
  }

  // Mostramos los eventos al cargar la página
  mostrarEventos();
</script>


</body>
</html>